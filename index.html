<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>思考法診断ツール</title>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/recharts/2.5.0/Recharts.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useRef } = React;
    const { RadarChart, PolarGrid, PolarAngleAxis, PolarRadiusAxis, Radar, ResponsiveContainer } = Recharts;

    // Lucide icons as SVG components
    const Brain = ({ className }) => (
      <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
      </svg>
    );

    const ArrowRight = ({ className }) => (
      <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 5l7 7-7 7" />
      </svg>
    );

    const RefreshCw = ({ className }) => (
      <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
      </svg>
    );

    const Download = ({ className }) => (
      <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
      </svg>
    );

    const ThinkingStyleAssessment = () => {
      const [currentQuestion, setCurrentQuestion] = useState(0);
      const [answers, setAnswers] = useState({});
      const [showResult, setShowResult] = useState(false);
      const resultRef = useRef(null);

      const questions = [
        { id: 1, text: "複雑な問題に直面したとき、まず事実を整理してステップバイステップで考える", type: "logical" },
        { id: 2, text: "情報を鵜呑みにせず、常に「本当にそうか?」と疑問を持つ", type: "critical" },
        { id: 3, text: "既存の枠組みにとらわれず、突飛なアイデアを思いつくことが多い", type: "lateral" },
        { id: 4, text: "一つのテーマについて、とことん深く掘り下げて考えるのが好き", type: "vertical" },
        { id: 5, text: "物事を個別ではなく、全体の関係性や影響を考える", type: "system" },
        { id: 6, text: "ユーザーや相手の立場に立って、共感しながら考える", type: "design" },
        { id: 7, text: "データや根拠に基づいて、論理的に結論を導き出す", type: "logical" },
        { id: 8, text: "前提条件や仮説の妥当性を検証することを重視する", type: "critical" },
        { id: 9, text: "常識的な答えよりも、ユニークな解決策を考えるのが得意", type: "lateral" },
        { id: 10, text: "表面的な理解ではなく、根本原因や本質を追求する", type: "vertical" },
        { id: 11, text: "部分最適ではなく、全体最適を考慮して判断する", type: "system" },
        { id: 12, text: "プロトタイプを作って試行錯誤しながら改善するのが好き", type: "design" },
        { id: 13, text: "問題解決のプロセスを明確に説明できる", type: "logical" },
        { id: 14, text: "多様な視点や反対意見を積極的に取り入れる", type: "critical" },
        { id: 15, text: "アナロジー(類似性)を使って、異なる分野からアイデアを借りる", type: "lateral" },
        { id: 16, text: "Why(なぜ)を繰り返して、問題の深層に迫る", type: "vertical" },
        { id: 17, text: "時間軸や影響範囲を考慮して、長期的な視点で考える", type: "system" },
        { id: 18, text: "実際に体験したり観察したりして、インサイトを得る", type: "design" },
      ];

      const thinkingStyles = {
        logical: { name: "論理的思考", description: "事実とデータに基づき、順序立てて考える力", scenes: "問題解決、プレゼン、意思決定" },
        critical: { name: "批判的思考", description: "情報を鵜呑みにせず、多角的に検証する力", scenes: "情報分析、リスク評価、戦略立案" },
        lateral: { name: "水平思考", description: "既存の枠を超え、創造的なアイデアを生む力", scenes: "新規事業、商品開発、ブレスト" },
        vertical: { name: "垂直思考", description: "一つのテーマを深く掘り下げ、本質に迫る力", scenes: "専門性追求、根本原因分析、研究" },
        system: { name: "システム思考", description: "全体の関係性と影響を俯瞰して考える力", scenes: "組織改革、プロセス改善、経営判断" },
        design: { name: "デザイン思考", description: "共感と試行錯誤を通じてイノベーションを起こす力", scenes: "UX改善、サービス設計、顧客体験" }
      };

      const handleAnswer = (value) => {
        const newAnswers = { ...answers, [currentQuestion]: value };
        setAnswers(newAnswers);

        if (currentQuestion < questions.length - 1) {
          setCurrentQuestion(currentQuestion + 1);
        } else {
          setShowResult(true);
        }
      };

      const calculateScores = () => {
        const scores = {
          logical: 0,
          critical: 0,
          lateral: 0,
          vertical: 0,
          system: 0,
          design: 0
        };

        questions.forEach((q, index) => {
          if (answers[index] !== undefined) {
            scores[q.type] += answers[index];
          }
        });

        return Object.keys(scores).map(key => ({
          subject: thinkingStyles[key].name,
          score: Math.round((scores[key] / 15) * 100),
          fullMark: 100
        }));
      };

      const getTopStyles = () => {
        const scores = calculateScores();
        return scores.sort((a, b) => b.score - a.score).slice(0, 3);
      };

      const getBottomStyles = () => {
        const scores = calculateScores();
        return scores.sort((a, b) => a.score - b.score).slice(0, 2);
      };

      const getPersonalizedAdvice = () => {
        const topStyles = getTopStyles();
        const bottomStyles = getBottomStyles();
        const allScores = calculateScores();
        const avgScore = allScores.reduce((sum, s) => sum + s.score, 0) / allScores.length;
        const isBalanced = allScores.every(s => Math.abs(s.score - avgScore) < 20);

        const adviceMap = {
          logical: {
            strength: "論理的思考が得意なあなたは、複雑な問題を整理し、説得力のある提案ができます。データ分析やプロジェクト管理の役割で力を発揮できます。",
            weakness: "論理的思考を強化するには、日々の意思決定で「なぜそう判断したのか」を言語化する習慣をつけましょう。フレームワーク(MECE、ロジックツリー等)の学習もおすすめです。",
            books: "『イシューからはじめよ』『ロジカル・シンキング』"
          },
          critical: {
            strength: "批判的思考が得意なあなたは、情報の真偽を見極め、リスクを事前に察知できます。意思決定の質を高める役割で貢献できます。",
            weakness: "批判的思考を鍛えるには、ニュースや提案に対して「前提は何か」「他の解釈は?」と問う習慣をつけましょう。ディベートや多様な意見に触れることも効果的です。",
            books: "『武器になる哲学』『クリティカルシンキング入門』"
          },
          lateral: {
            strength: "水平思考が得意なあなたは、既存の枠を超えた革新的なアイデアを生み出せます。新規事業や商品開発で独自の価値を創造できます。",
            weakness: "水平思考を伸ばすには、異業種の事例研究や、制約をあえて設けたブレストを試しましょう。「もし〜だったら?」と問うリフレーミングの練習も有効です。",
            books: "『水平思考の世界』『アイデアのちから』"
          },
          vertical: {
            strength: "垂直思考が得意なあなたは、物事の本質を見抜き、専門性を深めることができます。根本原因の究明や専門分野の探求で力を発揮します。",
            weakness: "垂直思考を磨くには、興味のあるテーマで「なぜ?」を5回繰り返す練習をしましょう。一次情報にあたり、深く学ぶ姿勢が重要です。",
            books: "『イシューからはじめよ』『なぜ?を5回繰り返す技術』"
          },
          system: {
            strength: "システム思考が得意なあなたは、全体像を俯瞰し、最適な解決策を導けます。組織改革やプロセス改善で大きな影響を与えられます。",
            weakness: "システム思考を強化するには、因果ループ図を描く練習や、時間軸を広げて影響を考える習慣をつけましょう。組織や自然のシステムから学ぶことも有効です。",
            books: "『システム思考』『学習する組織』"
          },
          design: {
            strength: "デザイン思考が得意なあなたは、ユーザーに寄り添い、試行錯誤を通じて価値を創造できます。顧客体験の向上や新サービス設計で活躍できます。",
            weakness: "デザイン思考を伸ばすには、実際のユーザー観察やインタビューを実践しましょう。小さなプロトタイプを素早く作り、フィードバックを得る経験が重要です。",
            books: "『デザイン思考が世界を変える』『UXデザインの教科書』"
          }
        };

        const advice = {
          strengths: [],
          improvements: [],
          balance: "",
          recommendations: []
        };

        topStyles.slice(0, 2).forEach(style => {
          const key = Object.keys(thinkingStyles).find(k => thinkingStyles[k].name === style.subject);
          if (adviceMap[key]) {
            advice.strengths.push({
              name: style.subject,
              text: adviceMap[key].strength,
              books: adviceMap[key].books
            });
          }
        });

        bottomStyles.forEach(style => {
          const key = Object.keys(thinkingStyles).find(k => thinkingStyles[k].name === style.subject);
          if (adviceMap[key] && style.score < 60) {
            advice.improvements.push({
              name: style.subject,
              text: adviceMap[key].weakness,
              books: adviceMap[key].books
            });
          }
        });

        if (isBalanced) {
          advice.balance = "全ての思考法がバランス良く発達しています。状況に応じて適切な思考法を使い分けられる柔軟性を持っています。";
        } else if (topStyles[0].score - bottomStyles[0].score > 40) {
          advice.balance = "特定の思考法に強みが偏っています。得意分野を活かしつつ、苦手な思考法を補完できるチームメンバーと協力すると効果的です。";
        } else {
          advice.balance = "思考法にある程度の偏りがありますが、学習によって幅を広げる余地があります。";
        }

        if (topStyles[0].subject === "論理的思考" || topStyles[0].subject === "批判的思考") {
          advice.recommendations.push("分析系の業務やレビュー役で力を発揮できます");
          advice.recommendations.push("時には直感や創造性も取り入れてみましょう");
        }
        if (topStyles[0].subject === "水平思考" || topStyles[0].subject === "デザイン思考") {
          advice.recommendations.push("アイデア創出やイノベーション推進の役割が適しています");
          advice.recommendations.push("実行時には論理的な検証も組み合わせましょう");
        }
        if (topStyles.some(s => s.subject === "システム思考")) {
          advice.recommendations.push("全体最適の視点で、組織横断的なプロジェクトに貢献できます");
        }

        return advice;
      };

      const reset = () => {
        setCurrentQuestion(0);
        setAnswers({});
        setShowResult(false);
      };

      const getDateString = () => {
        const now = new Date();
        const year = now.getFullYear();
        const month = String(now.getMonth() + 1).padStart(2, '0');
        const day = String(now.getDate()).padStart(2, '0');
        return `${year}-${month}-${day}`;
      };

      const downloadAsImage = async () => {
        if (!resultRef.current) return;

        try {
          const canvas = await html2canvas(resultRef.current, {
            scale: 2,
            backgroundColor: '#ffffff',
            logging: false,
          });
          
          const link = document.createElement('a');
          link.download = `思考法診断結果_${getDateString()}.png`;
          link.href = canvas.toDataURL('image/png');
          link.click();
        } catch (error) {
          console.error('画像の保存に失敗しました:', error);
          alert('画像の保存に失敗しました。もう一度お試しください。');
        }
      };

      if (showResult) {
        const chartData = calculateScores();
        const topStyles = getTopStyles();
        const personalAdvice = getPersonalizedAdvice();

        return (
          <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-8">
            <div className="max-w-4xl mx-auto">
              <div ref={resultRef} className="bg-white rounded-2xl shadow-xl p-8">
                <div className="flex items-center gap-3 mb-6">
                  <Brain className="w-8 h-8 text-indigo-600" />
                  <h1 className="text-3xl font-bold text-gray-800">診断結果</h1>
                  <span className="ml-auto text-sm text-gray-500">{getDateString()}</span>
                </div>

                <div className="mb-8">
                  <ResponsiveContainer width="100%" height={400}>
                    <RadarChart data={chartData}>
                      <PolarGrid />
                      <PolarAngleAxis dataKey="subject" />
                      <PolarRadiusAxis angle={90} domain={[0, 100]} />
                      <Radar name="あなたの思考スタイル" dataKey="score" stroke="#4f46e5" fill="#4f46e5" fillOpacity={0.6} />
                    </RadarChart>
                  </ResponsiveContainer>
                </div>

                <div className="bg-indigo-50 rounded-lg p-6 mb-6">
                  <h2 className="text-xl font-bold text-gray-800 mb-4">あなたの得意な思考法 TOP3</h2>
                  <div className="space-y-4">
                    {topStyles.map((style, index) => {
                      const key = Object.keys(thinkingStyles).find(k => thinkingStyles[k].name === style.subject);
                      const info = thinkingStyles[key];
                      return (
                        <div key={index} className="bg-white rounded-lg p-4">
                          <div className="flex items-center justify-between mb-2">
                            <h3 className="font-bold text-lg text-indigo-600">
                              {index + 1}位: {style.subject}
                            </h3>
                            <span className="text-2xl font-bold text-indigo-600">{style.score}%</span>
                          </div>
                          <p className="text-gray-600 text-sm mb-2">{info.description}</p>
                          <p className="text-gray-500 text-xs">
                            <span className="font-semibold">活用シーン:</span> {info.scenes}
                          </p>
                        </div>
                      );
                    })}
                  </div>
                </div>

                <div className="bg-green-50 border border-green-200 rounded-lg p-6 mb-6">
                  <h2 className="text-xl font-bold text-green-800 mb-4">💪 あなたの強みを活かすアドバイス</h2>
                  <div className="space-y-4">
                    {personalAdvice.strengths.map((item, index) => (
                      <div key={index} className="bg-white rounded-lg p-4">
                        <h3 className="font-bold text-green-700 mb-2">{item.name}</h3>
                        <p className="text-gray-700 text-sm mb-2">{item.text}</p>
                        <p className="text-xs text-gray-500">
                          <span className="font-semibold">📚 おすすめ書籍:</span> {item.books}
                        </p>
                      </div>
                    ))}
                  </div>
                </div>

                {personalAdvice.improvements.length > 0 && (
                  <div className="bg-blue-50 border border-blue-200 rounded-lg p-6 mb-6">
                    <h2 className="text-xl font-bold text-blue-800 mb-4">🌱 成長のためのアドバイス</h2>
                    <div className="space-y-4">
                      {personalAdvice.improvements.map((item, index) => (
                        <div key={index} className="bg-white rounded-lg p-4">
                          <h3 className="font-bold text-blue-700 mb-2">{item.name}</h3>
                          <p className="text-gray-700 text-sm mb-2">{item.text}</p>
                          <p className="text-xs text-gray-500">
                            <span className="font-semibold">📚 おすすめ書籍:</span> {item.books}
                          </p>
                        </div>
                      ))}
                    </div>
                  </div>
                )}

                <div className="bg-purple-50 border border-purple-200 rounded-lg p-6 mb-6">
                  <h2 className="text-xl font-bold text-purple-800 mb-3">🎯 総合的なアドバイス</h2>
                  <p className="text-gray-700 text-sm mb-4">{personalAdvice.balance}</p>
                  {personalAdvice.recommendations.length > 0 && (
                    <div className="bg-white rounded-lg p-4">
                      <h3 className="font-semibold text-purple-700 mb-2">実践のヒント:</h3>
                      <ul className="space-y-1">
                        {personalAdvice.recommendations.map((rec, index) => (
                          <li key={index} className="text-sm text-gray-700">• {rec}</li>
                        ))}
                      </ul>
                    </div>
                  )}
                </div>

                <div className="bg-gray-50 rounded-lg p-6 mb-6">
                  <h2 className="text-xl font-bold text-gray-800 mb-4">全ての思考法について</h2>
                  <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                    {Object.keys(thinkingStyles).map(key => {
                      const style = thinkingStyles[key];
                      const score = chartData.find(d => d.subject === style.name)?.score || 0;
                      return (
                        <div key={key} className="bg-white rounded-lg p-4 border border-gray-200">
                          <div className="flex justify-between items-center mb-2">
                            <h3 className="font-bold text-gray-800">{style.name}</h3>
                            <span className="text-sm font-semibold text-gray-600">{score}%</span>
                          </div>
                          <div className="w-full bg-gray-200 rounded-full h-2 mb-2">
                            <div className="bg-indigo-600 h-2 rounded-full" style={{ width: `${score}%` }}></div>
                          </div>
                          <p className="text-xs text-gray-600">{style.description}</p>
                        </div>
                      );
                    })}
                  </div>
                </div>

                <div className="bg-amber-50 border border-amber-200 rounded-lg p-4 mb-6">
                  <h3 className="font-bold text-amber-800 mb-2">💡 活用のヒント</h3>
                  <ul className="text-sm text-amber-900 space-y-1">
                    <li>• 得意な思考法を活かして、チーム内での役割を明確にしましょう</li>
                    <li>• 苦手な思考法は、それが得意な同僚と協力することで補完できます</li>
                    <li>• 意識的に苦手な思考法を使う練習をすることで、思考の幅が広がります</li>
                  </ul>
                </div>
              </div>

              <div className="mt-6 flex gap-4">
                <button
                  onClick={downloadAsImage}
                  className="flex-1 bg-green-600 text-white py-3 rounded-lg font-semibold hover:bg-green-700 transition flex items-center justify-center gap-2"
                >
                  <Download className="w-5 h-5" />
                  結果を保存(PNG)
                </button>
                <button
                  onClick={reset}
                  className="flex-1 bg-indigo-600 text-white py-3 rounded-lg font-semibold hover:bg-indigo-700 transition flex items-center justify-center gap-2"
                >
                  <RefreshCw className="w-5 h-5" />
                  もう一度診断する
                </button>
              </div>
            </div>
          </div>
        );
      }

      const progress = ((currentQuestion + 1) / questions.length) * 100;

      return (
        <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-8">
          <div className="max-w-2xl mx-auto">
            <div className="bg-white rounded-2xl shadow-xl p-8">
              <div className="flex items-center gap-3 mb-6">
                <Brain className="w-8 h-8 text-indigo-600" />
                <h1 className="text-3xl font-bold text-gray-800">思考法診断ツール</h1>
              </div>

              <div className="mb-8">
                <div className="flex justify-between text-sm text-gray-600 mb-2">
                  <span>質問 {currentQuestion + 1} / {questions.length}</span>
                  <span>{Math.round(progress)}%</span>
                </div>
                <div className="w-full bg-gray-200 rounded-full h-2">
                  <div 
                    className="bg-indigo-600 h-2 rounded-full transition-all duration-300"
                    style={{ width: `${progress}%` }}
                  ></div>
                </div>
              </div>

              <div className="mb-8">
                <div className="bg-indigo-50 rounded-lg p-6 mb-6">
                  <p className="text-lg text-gray-800 font-medium">
                    {questions[currentQuestion].text}
                  </p>
                </div>

                <div className="space-y-3">
                  {[
                    { value: 5, label: "非常に当てはまる" },
                    { value: 4, label: "やや当てはまる" },
                    { value: 3, label: "どちらともいえない" },
                    { value: 2, label: "あまり当てはまらない" },
                    { value: 1, label: "全く当てはまらない" }
                  ].map(option => (
                    <button
                      key={option.value}
                      onClick={() => handleAnswer(option.value)}
                      className="w-full bg-white border-2 border-gray-200 rounded-lg p-4 text-left hover:border-indigo-600 hover:bg-indigo-50 transition flex items-center justify-between group"
                    >
                      <span className="text-gray-700 group-hover:text-indigo-700 font-medium">
                        {option.label}
                      </span>
                      <ArrowRight className="w-5 h-5 text-gray-400 group-hover:text-indigo-600" />
                    </button>
                  ))}
                </div>
              </div>

              {currentQuestion > 0 && (
                <button
                  onClick={() => setCurrentQuestion(currentQuestion - 1)}
                  className="text-indigo-600 hover:text-indigo-700 text-sm font-medium"
                >
                  ← 前の質問に戻る
                </button>
              )}
            </div>
          </div>
        </div>
      );
    };

    ReactDOM.render(<ThinkingStyleAssessment />, document.getElementById('root'));
  </script>
</body>
</html>